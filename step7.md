ステップ6で作成した行列は、それ自体がネットワークの表現です。この最終ステップでは、この行列データを使って専門的なネットワーク分析を行い、その結果とグラフ構造を可視化します。

**前提:**
*   ステップ6までのコードに追記・修正します。
*   `project_data['adjacency_matrix']` にNumPy形式の正方行列が保存されている状態を想定します。

**要件:**
1.  **ライブラリの追加:** `networkx` をインポートしてください。
2.  **UIの追加:**
    *   ヒートマップの下に「5.2. ネットワーク分析」という小見出しと、「ネットワークを生成して分析」ボタンを設置してください。
3.  **ネットワーク生成と可視化ロジック:**
    *   「ネットワークを生成して分析」ボタンが押されたら、以下の処理を実行します。
    *   `project_data['adjacency_matrix']` から、`networkx.from_numpy_array()` を使って有向グラフオブジェクト (`nx.DiGraph`) を生成します。この時点では、ノード名は `0, 1, 2...` となっています。
    *   `project_data['nodes']` のリストを使い、`nx.relabel_nodes()` 関数でグラフのノード名を実際のノード名にマッピングしてください。
    *   `networkx.draw()` を使ってグラフを可視化します。
        *   **描画オプション:**
            *   `pos=nx.spring_layout(G)`: ノードの配置を計算します（他のレイアウト `circular_layout` なども試せるようにすると良い）。
            *   `with_labels=True`: ノード名を表示します。
            *   `node_color`, `node_size`, `font_size`, `width` (エッジの太さ) などを調整して見やすくしてください。
            *   エッジの色や太さを、評価スコア（正負や絶対値）に応じて変化させると、より高度な可視化になります（これは挑戦的な課題です）。
    *   `matplotlib.pyplot` を使ってグラフを描画し、`st.pyplot(fig)` で表示します。
4.  **ネットワーク分析ロジック:**
    *   生成したグラフオブジェクト `G` を使って、以下の中心性指標を計算してください。
        *   **PageRank:** `nx.pagerank(G)` を計算し、各ノードの影響力をスコア化します。
        *   **入次数中心性 (In-Degree Centrality):** `G.in_degree(weight='weight')` を計算し、他のノードから多くの影響を受けるノードを特定します。
        *   **出次数中心性 (Out-Degree Centrality):** `G.out_degree(weight='weight')` を計算し、他のノードに多くの影響を与えるノードを特定します。
5.  **分析結果の表示:**
    *   「分析結果」という見出しの下に、計算した各中心性指標をまとめたPandas DataFrameを作成し、`st.dataframe()` で表示してください。
    *   DataFrameのカラムは、「ノード名」「PageRankスコア」「入次数」「出次数」などとします。
    *   スコアの高い順にソートして表示すると、ユーザーにとって有益です。

**コード品質への要求:**
*   NetworkXのグラフ生成、可視化、分析の各ロジックは、それぞれ独立した関数として定義してください。
*   分析結果をDataFrameにまとめる処理は、辞書を作成してから一括でDataFrameに変換すると効率的です。

これで全ての機能要件が揃いました。この最終ステップのコードを生成し、私たちのプロジェクト「Process Insight Modeler」を完成させてください！